{"version":3,"file":"dro-pvvp-add-variation-images.js","mappings":";;;;;;;;;;;;AAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,mEAAmE,QAAQ,SAAS,eAAe,YAAY;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC","sources":["webpack://product-variations-view-react/./src/variation-images/dro-pvvp-add-variation-images.ts"],"sourcesContent":["\"use strict\";\n// declare var wp: any;\n// import* as  $ from 'jquery';\nclass ProductVariationImage {\n    constructor() { }\n    static getInstance() {\n        if (this.instance == null) {\n            this.instance = new ProductVariationImage();\n        }\n        return this.instance;\n    }\n    checkMediaAvailability() {\n        if (typeof wp !== 'undefined' && typeof wp.media !== 'undefined') {\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    // initialize events\n    init() {\n        jQuery(document).off('click', '.dro-pvvp-variation-images-add-image');\n        jQuery(document).off('click', '.dro-pvvp-variation-images-remove-image');\n        jQuery(document).on('click', '.dro-pvvp-variation-images-add-image', this.addImage);\n        // $(document).on('click', '.dro-pvvp-variation-images-remove-image', this.removeImage);\n        jQuery('.woocommerce_variation').each((index, element) => {\n            var optionsWrapper = jQuery(element).find('.options:first');\n            var galleryWrapper = jQuery(element).find('.dro-pvvp-variation-images-container');\n            galleryWrapper.insertBefore(optionsWrapper);\n        });\n        jQuery(document.body).on('click', '.dro-pvvp-handlediv', function () {\n            jQuery(this).closest('.dro-pvvp-variation-images-postbox').toggleClass('closed');\n            var ariaExpandedValue = !jQuery(this).closest('.dro-pvvp-variation-images-postbox').hasClass('closed');\n            jQuery(this).attr('aria-expanded', '' + ariaExpandedValue + '');\n        });\n    }\n    addImage(event) {\n        var _a;\n        var $this = this;\n        event.preventDefault();\n        event.stopPropagation();\n        var frame = null;\n        var product_variation_id = jQuery(this).data('dro-pvvp-variation-id');\n        var loop = jQuery(this).data('dro-pvvp-variation-loop');\n        if (typeof wp !== 'undefined' && wp.media && ((_a = wp.media) === null || _a === void 0 ? void 0 : _a.editor)) {\n            if (frame) {\n                frame === null || frame === void 0 ? void 0 : frame.open();\n                return;\n            }\n            frame = wp.media({\n                title: 'Select media',\n                button: {\n                    text: 'Add media'\n                },\n                library: {\n                    type: ['video', 'image']\n                }\n            });\n            frame === null || frame === void 0 ? void 0 : frame.on('select', function () {\n                var images = frame === null || frame === void 0 ? void 0 : frame.state().get('selection').toJSON();\n                var html = images.map(function (image) {\n                    if (image.type === 'image') {\n                        var id = image.id, _image$sizes = image.sizes;\n                        _image$sizes = _image$sizes === void 0 ? { full: { url: '' }, thumbnail: { url: '' } } : _image$sizes;\n                        var thumbnail = _image$sizes.thumbnail, full = _image$sizes.full;\n                        var url = thumbnail ? thumbnail.url : full.url;\n                        var template = wp.template('dro-pvvp-variation-image-collections');\n                        return template({\n                            id: id,\n                            url: url,\n                            product_variation_id: product_variation_id,\n                            loop: loop\n                        });\n                    }\n                }).join('');\n                jQuery($this).parent().prev().find('.dro-pvvp-variation-images-grid-images').append(html);\n            });\n            frame === null || frame === void 0 ? void 0 : frame.open();\n        }\n    }\n}\nProductVariationImage.instance = null;\n(function ($) {\n    $(function () {\n        const variationImageManager = ProductVariationImage.getInstance();\n        if (variationImageManager.checkMediaAvailability()) {\n            // variationImageManager.init();\n            $('#woocommerce-product-data').on('woocommerce_variations_loaded', function () {\n                variationImageManager.init();\n            });\n        }\n        else {\n            console.error('wp.media is NOT available! Ensure wp_enqueue_media() is called.');\n        }\n    });\n})(jQuery);\n"],"names":[],"sourceRoot":""}